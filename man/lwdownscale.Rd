% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatialdownscale.R
\name{lwdownscale}
\alias{lwdownscale}
\title{Downscale longwave radiation}
\usage{
lwdownscale(lwrad, tc, tcf, tme, dtmf, dtmc, skyview = NA, terrainshade = TRUE)
}
\arguments{
\item{lwrad}{\itemize{
\item coarse resolution downward longwave radiation (W/m^2)  as spatraster or array.
}}

\item{tc}{\itemize{
\item coarse resolution temperature (deg C) as spatraster or array.
}}

\item{tcf}{\itemize{
\item fine resolution spatraster of temperature (deg C) down-scaled to resolution of \code{dtmf}.
}}

\item{tme}{POSIXlt object of times corresponding to radiation values in
\code{lwrad}, \code{tc} and \code{tcf}.}

\item{dtmf}{a fine-resolution SpatRast of elevations.}

\item{dtmc}{SpatRast of elevations matching the resolution, extend and coordinate
reference system of \code{lwrad} and \code{tc}.}

\item{terrainshade}{\itemize{
\item boolean TRUE/FALSE
}}
}
\value{
a multi-layer SpatRast of downward longwave radiation (W/m^2)
matching the resolution of dtmf.
}
\description{
Downscales an array of longwave downward radiation data with option to
simulate terrain shading of skyview
}
\details{
radiation is downscaled by computing from temperature the difference in upward
longwave radiation at fine and coarse resolutions. Corrected LW down is then
corrected for terrain shading of skyview if requested.
}
\examples{
climdata<- read_climdata(mesoclim::ukcpinput)
dtmf<-terra::rast(system.file('extdata/dtms/dtmf.tif',package='mesoclim'))
dtmm<-terra::rast(system.file('extdata/dtms/dtmm.tif',package='mesoclim'))
tmean_c<-(climdata$tmin+climdata$tmax)/2
wsf<-winddownscale(climdata$windspeed, climdata$winddir, dtmf, dtmm, climdata$dtm, zi=climdata$windheight_m)
dailytemps<-tempdaily_downscale(climdata,NA,unwrap(mesoclim::ukcp18sst),dtmf,dtmm,NA,wsf,cad = FALSE,coastal = FALSE,2,2)
lw<-lwdownscale(climdata$lwrad,tmean_c,dailytemps$tmean, climdata$tme, dtmf=dtmf, dtmc=climdata$dtm)
lw <- lwdownscale(climdata$lwrad,climdata$ terra::rast(system.file('extdata/dtms/dtmf.tif',package='mesoclim')), climdata$dtm)
panel(c(lw[[1]],lw[[5]],lw[[10]],lw[[20]]),main=paste0("LW down ",c(1,5,10,15),"/05/2018"))
}
