<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Converts UKCP18 global or regional land data in the form of netCDF4 file (as returned
by ukcp18_downscale() to the correct data form required for subsequent modelling."><title>convert UKCP18 ncdf4 files to format required for model — ukcp18toclimarray • mesoclim</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="convert UKCP18 ncdf4 files to format required for model — ukcp18toclimarray"><meta property="og:description" content="Converts UKCP18 global or regional land data in the form of netCDF4 file (as returned
by ukcp18_downscale() to the correct data form required for subsequent modelling."><meta property="og:image" content="https://jrmosedale.github.io/mesoclim/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mesoclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mesoclim_1_download.html">1 Downloading Inputs</a>
    <a class="dropdown-item" href="../articles/mesoclim_2_preparedata.html">2. Data pre-processing</a>
    <a class="dropdown-item" href="../articles/mesoclim_3_spdscale.html">3. Spatial downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_tmpdscale.html">4. Temporal downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_5_biascorrect.html">5. Bias correction</a>
    <a class="dropdown-item" href="../articles/mesoclim_addtrees.html">ADDTREES Workflow without bias correction</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>convert UKCP18 ncdf4 files to format required for model</h1>
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/R/ukcp_functions.R"><code>R/ukcp_functions.R</code></a></small>
      <div class="d-none name"><code>ukcp18toclimarray.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Converts UKCP18 global or regional land data in the form of netCDF4 file (as returned
by <code>ukcp18_downscale()</code> to the correct data form required for subsequent modelling.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ukcp18toclimarray</span><span class="op">(</span></span>
<span>  <span class="va">dir_ukcp</span>,</span>
<span>  <span class="va">dtm</span>,</span>
<span>  <span class="va">startdate</span>,</span>
<span>  <span class="va">enddate</span>,</span>
<span>  collection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"land-gcm"</span>, <span class="st">"land-rcm"</span><span class="op">)</span>,</span>
<span>  domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uk"</span>, <span class="st">"eur"</span>, <span class="st">"global"</span><span class="op">)</span>,</span>
<span>  member <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"01"</span>, <span class="st">"02"</span>, <span class="st">"03"</span>, <span class="st">"04"</span>, <span class="st">"05"</span>, <span class="st">"06"</span>, <span class="st">"07"</span>, <span class="st">"08"</span>, <span class="st">"09"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"12"</span>,</span>
<span>    <span class="st">"13"</span>, <span class="st">"14"</span>, <span class="st">"15"</span>, <span class="st">"16"</span>, <span class="st">"17"</span>, <span class="st">"18"</span>, <span class="st">"19"</span>, <span class="st">"20"</span>, <span class="st">"21"</span>, <span class="st">"22"</span>, <span class="st">"23"</span>, <span class="st">"24"</span>, <span class="st">"25"</span>, <span class="st">"26"</span>,</span>
<span>    <span class="st">"27"</span>, <span class="st">"28"</span><span class="op">)</span>,</span>
<span>  wsalbedo <span class="op">=</span> <span class="fl">0.19</span>,</span>
<span>  bsalbedo <span class="op">=</span> <span class="fl">0.22</span>,</span>
<span>  ukcp_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"clt"</span>, <span class="st">"hurs"</span>, <span class="st">"pr"</span>, <span class="st">"psl"</span>, <span class="st">"rls"</span>, <span class="st">"rss"</span>, <span class="st">"tasmax"</span>, <span class="st">"tasmin"</span>, <span class="st">"uas"</span>,</span>
<span>    <span class="st">"vas"</span><span class="op">)</span>,</span>
<span>  ukcp_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"%"</span>, <span class="st">"%"</span>, <span class="st">"mm/day"</span>, <span class="st">"hPa"</span>, <span class="st">"watt/m^2"</span>, <span class="st">"watt/m^2"</span>, <span class="st">"degC"</span>, <span class="st">"degC"</span>,</span>
<span>    <span class="st">"m/s"</span>, <span class="st">"m/s"</span><span class="op">)</span>,</span>
<span>  output_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"%"</span>, <span class="st">"%"</span>, <span class="st">"mm/day"</span>, <span class="st">"kPa"</span>, <span class="st">"watt/m^2"</span>, <span class="st">"watt/m^2"</span>, <span class="st">"degC"</span>, <span class="st">"degC"</span>,</span>
<span>    <span class="st">"m/s"</span>, <span class="st">"m/s"</span><span class="op">)</span>,</span>
<span>  toArrays <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sampleplot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dir_ukcp</dt>
<dd><p>directory holding ALL ncdf files of UKCP18 data required to extract the requested variables and timeseries.</p></dd>


<dt>dtm</dt>
<dd><p>SpatRaster object of elevations covering the geographical extent required (see details)</p></dd>


<dt>startdate</dt>
<dd><p>POSIXlt class defining start date of required timeseries</p></dd>


<dt>enddate</dt>
<dd><p>POSIXlt class defining end date of required timeseries</p></dd>


<dt>collection</dt>
<dd><p>text string defining UKCP18 collection, either 'land-gcm' or 'land-rcm'</p></dd>


<dt>domain</dt>
<dd><p>text string defining UKCP18 domain, either 'uk' or 'eur'(land-rcm collection only) or 'global'</p></dd>


<dt>member</dt>
<dd><p>string defining the climate model member to be used for the timeseries. Available members vary between UKCP18 collections.</p></dd>


<dt>ukcp_vars</dt>
<dd><p>UKCP18 variable names to be extracted DO NOT CHANGE</p></dd>


<dt>ukcp_units</dt>
<dd><p>units of the UKCP18 variables extracted DO NOT CHANGE</p></dd>


<dt>output_units</dt>
<dd><p>units required for output DO NOT CHANGE CHECK CORRECT</p></dd>


<dt>toArrays</dt>
<dd><p>logical determining if climate data returned as list of arrays. If FALSE returns list of Spatrasts.</p></dd>


<dt>sampleplot</dt>
<dd><p>if TRUE plots examples of interpolated dates when converting from 360 to 366 day years</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list of the following:</p><dl><dt>dtm</dt>
<dd><p>Digital elevation of downscaled area in metres (as Spatraster)</p></dd>

<dt>tme</dt>
<dd><p>POSIXlt object of times corresponding to climate observations</p></dd>

<dt>windheight_m</dt>
<dd><p>Height of windspeed data in metres above ground (as numeric)</p></dd>

<dt>tempheight_m</dt>
<dd><p>Height of temperature data in metres above ground (as numeric)</p></dd>

<dt>temp</dt>
<dd><p>Temperature (deg C)</p></dd>

<dt>relhum</dt>
<dd><p>Relative humidity (Percentage)</p></dd>

<dt>pres</dt>
<dd><p>Sea-level atmospheric pressure (kPa)</p></dd>

<dt>swrad</dt>
<dd><p>Total downward shortwave radiation (W/m^2)</p></dd>

<dt>difrad</dt>
<dd><p>Downward diffuse radiation (W / m^2)</p></dd>

<dt>lwrad</dt>
<dd><p>Total downward longwave radiation (W/m^2)</p></dd>

<dt>windspeed</dt>
<dd><p>At <code>windheight_m</code> above ground` (m/s)</p></dd>

<dt>winddir</dt>
<dd><p>Wind direction (decimal degrees)</p></dd>

<dt>prec</dt>
<dd><p>Precipitation (mm)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function converts 360 day UKCP18 to actual calendar data by reassignment and linear interpolation of missing data.
Returned climate data will be at the extent, corrdinate reference system of the UKCP18 data requested, which can vary between domains and collections.
The extent will be provided by the <code>dtm</code> which, if necessary, will be re-projected and resampled to the CRS and resolution of UKCP18 data requested.
For regional UKCP18 data, it is recommended that 'dtm' is derived from the original orography data available for download.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dir_ukcp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/ukcp18rcm'</span>,package<span class="op">=</span><span class="st">'mesoclim'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dtm</span><span class="op">&lt;-</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/ukcp18rcm/orog_land-rcm_uk_12km_osgb.nc'</span>,package<span class="op">=</span><span class="st">'mesoclim'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dtm</span><span class="op">&lt;-</span><span class="fu">crop</span><span class="op">(</span><span class="va">dtm</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">28077.86</span>, <span class="fl">339436.5</span>, <span class="op">-</span><span class="fl">57947.13</span>, <span class="fl">204298.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in crop(dtm, c(28077.86, 339436.5, -57947.13, 204298.7)):</span> could not find function "crop"</span>
<span class="r-in"><span><span class="va">ukcpinput</span><span class="op">&lt;-</span><span class="fu">ukcp18toclimarray</span><span class="op">(</span><span class="va">dir_ukcp</span>,<span class="va">dtm</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="st">'2018/05/01'</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="st">'2018/05/31'</span><span class="op">)</span>,collection<span class="op">=</span><span class="st">'land-rcm'</span>,domain<span class="op">=</span><span class="st">'uk'</span>,member<span class="op">=</span><span class="st">'01'</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading clt_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading hurs_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading pr_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading psl_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading rls_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading rss_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading tasmax_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading tasmin_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading uas_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading vas_rcp85_land-rcm_uk_12km_01_day_20101201-20201130.nc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using constant land and sea albedo values - assuming NA values in dtmc are sea!!</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ilya Maclean, Alexandra Gardner, Jonathan Mosedale.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

