<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Derives an array of hourly radiation values from an array of daily radiation values."><title>Daily to hourly shortwave radiation — swrad_dailytohourly • mesoclim</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Daily to hourly shortwave radiation — swrad_dailytohourly"><meta property="og:description" content="Derives an array of hourly radiation values from an array of daily radiation values."><meta property="og:image" content="https://jrmosedale.github.io/mesoclim/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mesoclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mesoclim_1_preparedata.html">1. Data pre-processing</a>
    <a class="dropdown-item" href="../articles/mesoclim_2_spdscale.html">Spatial Downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_3_tmpdscale.html">Temporal Downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_biascorrect.html">Bias Correction</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_biascorrect_explore.html">4. Bias correction</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Daily to hourly shortwave radiation</h1>
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/R/temporaldownscale.R"><code>R/temporaldownscale.R</code></a></small>
      <div class="d-none name"><code>swrad_dailytohourly.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Derives an array of hourly radiation values from an array of daily radiation values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">swrad_dailytohourly</span><span class="op">(</span><span class="va">radsw</span>, tme <span class="op">=</span> <span class="cn">NA</span>, r <span class="op">=</span> <span class="cn">NA</span>, clearsky <span class="op">=</span> <span class="cn">NA</span>, adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>radsw</dt>
<dd><ul><li><p>an array of daily mean radiation values (W/m**2)</p></li>
</ul></dd>


<dt>tme</dt>
<dd><ul><li><p>POSIXlt object of dates corresponding to radsw</p></li>
</ul></dd>


<dt>r</dt>
<dd><ul><li><p>if radsw is a spatraster r=NA
- if radsw is an array, r is a terra::SpatRaster object giving the extent of radsw
- if radsw is a vector of c(lat,lon) of the location radsw describes</p></li>
</ul></dd>


<dt>clearsky</dt>
<dd><ul><li><p>optionally an array with dimensions matching radsw of daily clearsky
radiation as returned by clearskyraddaily(). Calculated if not supplied</p></li>
</ul></dd>


<dt>adjust</dt>
<dd><ul><li><p>optional logical which if TRUE ensures that, after interpolation, returned
hourly values, when averaged to daily, match the input</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an array of hourly radiation values (W/m**2)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>NB - this assumes input radiation is downward flux, not net radiation (as assumed in UKCP)
to get from net to downward flux we need to recognise that rswnet = (1-alb)*radsw, so
radsw = rswnet/(1-alb), where alb is white sky albedo. White-sky albedo changes as a function
of solar angle, but in a manner dependent on ground reflectance, leaf area, leaf inclination
angles and leaf transmittance and the ratio of diffuse and direct. There are too
many vegetation parameter unknowns to reverse engineer, so suggest ignoring this.
discrepancies probably quite minor expect in areas with very low cover and will be handled
mostly by bias correction anyway
~~ * Need to spline interpolate clear-sky fraction (bounding by 1 and 0) and
~~   then calculate clear-sky radiation
~~ * Need to spline interpolate sky emissvity (bounding by 1 and 0) and
~~   then calculate longwave</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="co"># ~~~~~~~~~~~~~~~~~~~~ input provided as SpatRaster ======================= #</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="va">climdaily</span><span class="op">&lt;-</span> <span class="fu"><a href="read_climdata.html">read_climdata</a></span><span class="op">(</span><span class="fu">mesoclim</span><span class="fu">::</span><span class="va"><a href="ukcpinput.html">ukcpinput</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hrsw</span> <span class="op">&lt;-</span> <span class="fu">swrad_dailytohourly</span><span class="op">(</span><span class="va">climdaily</span><span class="op">$</span><span class="va">swrad</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot results for one cell</span></span></span>
<span class="r-in"><span><span class="va">cell_sw</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">extract</span><span class="op">(</span><span class="va">hrsw</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">175000</span>,<span class="fl">40000</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu">as_datetime</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">hrsw</span><span class="op">)</span><span class="op">)</span>,<span class="va">cell_sw</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="swrad_dailytohourly-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="co"># ~~~~~~~~~~~~~~~~~~~~ input provided as 3D array ======================= #</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="va">hrsw</span> <span class="op">&lt;-</span> <span class="fu">swrad_dailytohourly</span><span class="op">(</span><span class="fu">.is</span><span class="op">(</span><span class="va">climdaily</span><span class="op">$</span><span class="va">swrad</span><span class="op">)</span>,tme<span class="op">=</span><span class="va">climdaily</span><span class="op">$</span><span class="va">tme</span>,r<span class="op">=</span><span class="va">climdaily</span><span class="op">$</span><span class="va">dtm</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in .is(climdaily$swrad):</span> could not find function ".is"</span>
<span class="r-in"><span><span class="va">cell_sw</span><span class="op">&lt;-</span><span class="va">hrsw</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">hr_tme</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">climdaily</span><span class="op">$</span><span class="va">tme</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">+</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hr_tme</span><span class="op">)</span>,y<span class="op">=</span><span class="va">cell_sw</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in matplot(x = as.numeric(hr_tme), y = cell_sw, type = "l", lty = 1):</span> 'x' and 'y' must have same number of rows</span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="co"># ~~~~~~~~~~~~~~~~~~~~ input provided as vector =========================== #</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="va">radsw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>,<span class="fl">150</span>,<span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3600</span> <span class="op">*</span> <span class="fl">24</span>, origin <span class="op">=</span> <span class="st">"2018-05-01"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">0</span><span class="op">)</span> <span class="co"># (lat,lon of location)</span></span></span>
<span class="r-in"><span><span class="va">hrsw</span> <span class="op">&lt;-</span> <span class="fu">swrad_dailytohourly</span><span class="op">(</span><span class="va">radsw</span>,<span class="va">tme</span>,<span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hr_tme</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tme</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">+</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot results to compare</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hr_tme</span><span class="op">)</span>,y<span class="op">=</span><span class="va">hrsw</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="swrad_dailytohourly-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">radsw</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">global</span><span class="op">(</span><span class="va">climdaily</span><span class="op">$</span><span class="va">swrad</span>,<span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tme</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">climdaily</span><span class="op">$</span><span class="va">swrad</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="op">-</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hrsw</span> <span class="op">&lt;-</span> <span class="fu">swrad_dailytohourly</span><span class="op">(</span><span class="va">radsw</span>,<span class="va">tme</span>,<span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hr_tme</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tme</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">+</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot results to compare</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hr_tme</span><span class="op">)</span>,y<span class="op">=</span><span class="va">hrsw</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="swrad_dailytohourly-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ilya Maclean, Alexandra Gardner, Jonathan Mosedale.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

