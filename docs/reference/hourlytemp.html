<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generates a plausible vector or SpatRaster of hourly temperatures
from daily data."><title>Derives hourly temperature from daily data — hourlytemp • mesoclim</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derives hourly temperature from daily data — hourlytemp"><meta property="og:description" content="Generates a plausible vector or SpatRaster of hourly temperatures
from daily data."><meta property="og:image" content="https://jrmosedale.github.io/mesoclim/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mesoclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mesoclim_1_download.html">1 Downloading Inputs</a>
    <a class="dropdown-item" href="../articles/mesoclim_2_preparedata.html">2. Data pre-processing</a>
    <a class="dropdown-item" href="../articles/mesoclim_3_spdscale.html">3. Spatial downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_tmpdscale.html">4. Temporal downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_5_biascorrect.html">5. Bias correction</a>
    <a class="dropdown-item" href="../articles/mesoclim_addtrees.html">ADDTREES Workflow without bias correction</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derives hourly temperature from daily data</h1>
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/R/temporaldownscale.R"><code>R/temporaldownscale.R</code></a></small>
      <div class="d-none name"><code>hourlytemp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates a plausible vector or SpatRaster of hourly temperatures
from daily data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hourlytemp</span><span class="op">(</span><span class="va">tmn</span>, <span class="va">tmx</span>, tme <span class="op">=</span> <span class="cn">NA</span>, lat <span class="op">=</span> <span class="cn">NA</span>, long <span class="op">=</span> <span class="cn">NA</span>, srte <span class="op">=</span> <span class="fl">0.09</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tmn</dt>
<dd><p>a vector or SpatRaster of daily minimum temperatures (deg C)</p></dd>


<dt>tmx</dt>
<dd><p>a vector or SpatRaster of daily maximum temperatures (deg C)</p></dd>


<dt>tme</dt>
<dd><p>POSIXlt object of dates. Only required if <code>tmn</code> and
<code>tmx</code> are vectors.</p></dd>


<dt>lat</dt>
<dd><p>latitude of location (decimal degrees). Only required if <code>tmn</code> and
<code>tmx</code> are vectors</p></dd>


<dt>srte</dt>
<dd><p>a parameter controlling speed of decay of night time temperatures (see details)</p></dd>


<dt>lon</dt>
<dd><p>longitude of location (decimal degrees). Only required if <code>tmn</code> and
<code>tmx</code> are vectors</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Daytime temperatures are assumed to follow a sine curve with a peak a
short while after solar noon. After dusk, the temperatures are assumed to decay
exponentially reaching a minimum at dawn. The day in which tmx and tmn fall is
assumed to match UTC days. The parameter <code>stre</code> controls the speed of decay of
night time temperatures with time. A value of zero ensures values drop to minimum
at dawn the following day, but trial and error indicates in most circumstances
temperatures decay faster than this. The default value of 0.09 is an optimal
value derived using ERA5 data for western Europe, but performs reasonably well
globally</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">climdata</span><span class="op">&lt;-</span> <span class="fu"><a href="read_climdata.html">read_climdata</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/era5/input.rds'</span>,package<span class="op">=</span><span class="st">'mesoclim'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tc</span><span class="op">&lt;-</span><span class="va">climdata</span><span class="op">$</span><span class="va">temp</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="co"># ~~~~~~~~~~~~~~~~~~~~ input provided as vector =========================== #</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="co"># Derive daily tmx and tmn from hourly era5 data</span></span></span>
<span class="r-in"><span><span class="va">tch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tc</span>, <span class="fl">3</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">tch</span>, ncol <span class="op">=</span> <span class="fl">24</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tcm</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tcm</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3600</span> <span class="op">*</span> <span class="fl">24</span>, origin <span class="op">=</span> <span class="st">"2018-05-01"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Use interpolation function</span></span></span>
<span class="r-in"><span><span class="va">tcp</span> <span class="op">&lt;-</span> <span class="fu">hourlytemp</span><span class="op">(</span><span class="va">tmn</span>, <span class="va">tmx</span>, <span class="va">tme</span>, <span class="fl">50</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmeh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">climdata</span><span class="op">$</span><span class="va">tme</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot results to compare</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tch</span> <span class="op">~</span> <span class="va">tmeh</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">18</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Date"</span>, ylab <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tcp</span> <span class="op">~</span> <span class="va">tmeh</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">18</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="co"># ~~~~~~~~~~~~~~~~~~~~ input provided as SpatRaster ======================= #</span></span></span>
<span class="r-in"><span><span class="co"># ========================================================================= #</span></span></span>
<span class="r-in"><span><span class="va">dtmc</span> <span class="op">&lt;-</span> <span class="va">climdata</span><span class="op">$</span><span class="va">dtm</span></span></span>
<span class="r-in"><span><span class="co"># Derive tmx and tmn from hourly and convert to spatraster</span></span></span>
<span class="r-in"><span><span class="va">tmn</span> <span class="op">&lt;-</span> <span class="fu"><a href="dot-rast.html">.rast</a></span><span class="op">(</span><span class="fu">.hourtodayCpp</span><span class="op">(</span><span class="va">tc</span>, <span class="st">"min"</span><span class="op">)</span>,<span class="va">dtmc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmx</span> <span class="op">&lt;-</span> <span class="fu"><a href="dot-rast.html">.rast</a></span><span class="op">(</span><span class="fu">.hourtodayCpp</span><span class="op">(</span><span class="va">tc</span>, <span class="st">"max"</span><span class="op">)</span>,<span class="va">dtmc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Use interpolation function</span></span></span>
<span class="r-in"><span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu">hourlytemp</span><span class="op">(</span><span class="va">tmn</span>, <span class="va">tmx</span>, <span class="va">tme</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot results to compare</span></span></span>
<span class="r-in"><span><span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="dot-rast.html">.rast</a></span><span class="op">(</span><span class="va">tc</span>,<span class="va">dtmc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tc</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">-</span><span class="va">tp</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,main<span class="op">=</span><span class="st">'Difference (tc-tp) for coldest tc hour'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tc</span><span class="op">[[</span><span class="fl">665</span><span class="op">]</span><span class="op">]</span><span class="op">-</span><span class="va">tp</span><span class="op">[[</span><span class="fl">665</span><span class="op">]</span><span class="op">]</span>,main<span class="op">=</span><span class="st">'Difference (tc-tp) for hottest tc hour'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ilya Maclean, Alexandra Gardner, Jonathan Mosedale.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

