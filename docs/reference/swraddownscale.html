<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Downscales an array of shortwave radiation data with option to
simulate cloud patchiness and calculate diffuse radiation"><title>Downscale shortwave radiation — swdownscale • mesoclim</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Downscale shortwave radiation — swdownscale"><meta property="og:description" content="Downscales an array of shortwave radiation data with option to
simulate cloud patchiness and calculate diffuse radiation"><meta property="og:image" content="https://jrmosedale.github.io/mesoclim/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mesoclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mesoclim_1_download.html">1 Downloading Inputs</a>
    <a class="dropdown-item" href="../articles/mesoclim_2_preparedata.html">2. Data pre-processing</a>
    <a class="dropdown-item" href="../articles/mesoclim_3_spdscale.html">3. Spatial downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_tmpdscale.html">4. Temporal downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_5_biascorrect.html">5. Bias correction</a>
    <a class="dropdown-item" href="../articles/mesoclim_addtrees.html">ADDTREES Workflow without bias correction</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Downscale shortwave radiation</h1>
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/R/spatialdownscale.R"><code>R/spatialdownscale.R</code></a></small>
      <div class="d-none name"><code>swraddownscale.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Downscales an array of shortwave radiation data with option to
simulate cloud patchiness and calculate diffuse radiation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">swdownscale</span><span class="op">(</span></span>
<span>  <span class="va">swrad</span>,</span>
<span>  <span class="va">tme</span>,</span>
<span>  <span class="va">dtmf</span>,</span>
<span>  <span class="va">dtmc</span>,</span>
<span>  patchsim <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">swrad</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  terrainshade <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>swrad</dt>
<dd><p>an array of shortwave radiation (W/m^2).</p></dd>


<dt>tme</dt>
<dd><p>POSIXlt object of times corresponding to radiation values in <code>swrad</code>.</p></dd>


<dt>dtmf</dt>
<dd><p>a fine-resolution SpatRast of elevations. Temperatures down-scaled
to resolution of <code>dtmf</code>.</p></dd>


<dt>dtmc</dt>
<dd><p>SpatRast of elevations matching the resolution, extend and coordinate
reference system of of <code>swrad</code>.</p></dd>


<dt>patchsim</dt>
<dd><p>optional logical indicating whether to simulate cloud cover
patchiness during downscaling. More realistically captures variation, but slower.</p></dd>


<dt>nsim</dt>
<dd><p>optionally the number of independent cloud cover patchiness simulations to perform. Outputs
are temporally interpolated (see details).</p></dd>


<dt>terrainshade</dt>
<dd><p>optional logical indicating whether to adjust incoming radiation
for terrain shading. If TRUE, total downward shortwave radiation is partioned into its
direct and diffuse components, the latter adjusted by sky view and the former set
to zero if the sun is below the horizon, which is computed explicitly.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>if <code>terrainshade = FALSE</code> a multi-layer SpatRast of shortwave radiation
(W/m^2) matching the resolution of dtmf. If if <code>terrainshade = TRUE</code> a list of wrapped multi-layer
SpatRasts of (1) shortwave radiation (W/m^2) and (2) the diffuse fraction (range 0-1).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>radiation is downscaled by computing average fraction of clear-sky radiation
and then adjusting this variable to account for elevation using an emprical
adjustment calibrated against 0.05 degree data for the UK. If
<code>patchsim</code> is set to TRUE cloud cover patchiness is simulated the gstats package.
The parameter <code>nsim</code> determines the number of independent simulations and hence
the time intervals at which these simulations are performed. Simulated anomalies
due to local cloud patchiness are then interpolated temporally between these
periods. This ensures that, over shorter increments of say and hour, the location
clouds within each hour retain a degree of inter-dependence more realistically
simulating the trajectory of cloud as they move across the landscape.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">climdata</span><span class="op">&lt;-</span> <span class="fu"><a href="read_climdata.html">read_climdata</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/preprepdata/ukcp18rcm.Rds'</span>,package<span class="op">=</span><span class="st">'mesoclim'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">swradf</span><span class="op">&lt;-</span><span class="fu">swdownscale</span><span class="op">(</span><span class="va">climdata</span><span class="op">$</span><span class="va">swrad</span>, <span class="va">climdata</span><span class="op">$</span><span class="va">tme</span>,  <span class="fu">rast</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/dtms/dtmf.tif'</span>,package<span class="op">=</span><span class="st">'mesoclim'</span><span class="op">)</span><span class="op">)</span>, <span class="va">ukcpinput</span><span class="op">$</span><span class="va">dtm</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>is.na() applied to non-(list or vector) of type 'S4'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (classes, fdef, mtable) {    methods &lt;- .findInheritedMethods(classes, fdef, mtable)    if (length(methods) == 1L)         return(methods[[1L]])    else if (length(methods) == 0L) {        cnames &lt;- paste0("\"", vapply(classes, as.character,             ""), "\"", collapse = ", ")        stop(gettextf("unable to find an inherited method for function %s for signature %s",             sQuote(fdef@generic), sQuote(cnames)), domain = NA)    }    else stop("Internal error in finding inherited methods; didn't return a unique method",         domain = NA)})(list("logical"), new("standardGeneric", .Data = function (test,     ...) standardGeneric("ifel"), generic = structure("ifel", package = "terra"),     package = "terra", group = list(), valueClass = character(0),     signature = "test", default = NULL, skeleton = (function (test,         ...)     stop(gettextf("invalid call in method dispatch to '%s' (no default method)",         "ifel"), domain = NA))(test, ...)), &lt;environment&gt;):</span> unable to find an inherited method for function ‘ifel’ for signature ‘"logical"’</span>
<span class="r-in"><span><span class="fu"><a href="plot_q_layers.html">plot_q_layers</a></span><span class="op">(</span><span class="va">swradf</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'global': object 'swradf' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ilya Maclean, Alexandra Gardner, Jonathan Mosedale.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

