<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Downscales daily coarse-resolution temperature stats accounting for elevation
effects and optionally cold air drainage and coastal effects"><title>Downscale daily temperatures — tempdaily_downscale • mesoclim</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Downscale daily temperatures — tempdaily_downscale"><meta property="og:description" content="Downscales daily coarse-resolution temperature stats accounting for elevation
effects and optionally cold air drainage and coastal effects"><meta property="og:image" content="https://jrmosedale.github.io/mesoclim/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mesoclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mesoclim_1_preparedata.html">1. Data pre-processing</a>
    <a class="dropdown-item" href="../articles/mesoclim_2_spdscale.html">Spatial Downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_3_tmpdscale.html">Temporal Downscaling</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_biascorrect.html">Bias Correction</a>
    <a class="dropdown-item" href="../articles/mesoclim_4_biascorrect_explore.html">4. Bias correction</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Downscale daily temperatures</h1>
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/R/spatialdownscale.R"><code>R/spatialdownscale.R</code></a></small>
      <div class="d-none name"><code>tempdaily_downscale.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Downscales daily coarse-resolution temperature stats accounting for elevation
effects and optionally cold air drainage and coastal effects</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tempdaily_downscale</span><span class="op">(</span></span>
<span>  <span class="va">climdata</span>,</span>
<span>  tmean <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  sst <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">dtmf</span>,</span>
<span>  <span class="va">dtmm</span>,</span>
<span>  <span class="va">basins</span>,</span>
<span>  <span class="va">uzf</span>,</span>
<span>  cad <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  coastal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  thgto <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  whgto <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>climdata</dt>
<dd><p>a <code>climdata</code> model object containing climate data of the same format as <code>era5climdata</code>
Expects variables to include a <code>tmin</code> and <code>tmax</code></p></dd>


<dt>tmean</dt>
<dd><p>a coarse resolution array or spatRaster of daily mean temperatures identical to climdata inputs.
If NA will calculate from hourluy downscaling of tmin and tmax in <code>climdata</code></p></dd>


<dt>sst</dt>
<dd><p>a SpatRast of sea-surface temperature data (deg C) timeseries that overlaps climdata$tme</p></dd>


<dt>dtmf</dt>
<dd><p>a high-resolution SpatRast of elevations</p></dd>


<dt>dtmm</dt>
<dd><p>a medium-resolution SpatRast of elevations covering a larger area
than dtmf (only needed for coastal effects - see details).</p></dd>


<dt>basins</dt>
<dd><p>optionally, a fine-resolution SpatRast of basins as returned by <code><a href="basindelin.html">basindelin()</a></code>
matching the coordinate reference system and extent of <code>dtmf</code>. Calculated if
not supplied.</p></dd>


<dt>uzf</dt>
<dd><p>optionally, a SpatRast of fine resolution wind speeds as returned by <code><a href="winddownscale.html">winddownscale()</a></code>.
Calculated if not supplied.</p></dd>


<dt>cad</dt>
<dd><p>optional logical indicating whether to calculate cold-air drainage effects</p></dd>


<dt>coastal</dt>
<dd><p>optional logical indicating whether to calculate coastal effects</p></dd>


<dt>thgto</dt>
<dd><p>height above ground of output temperature measurements.</p></dd>


<dt>whgto</dt>
<dd><p>height above ground of output wind speed measurements.
to resolution of <code>dtmf</code>.</p></dd>


<dt>tempvar</dt>
<dd><p>string name of element of climdata holding temperature data (ie 'temp','tmax','tmin')</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list of three multi-layer SpatRasters of downscaled daily minimum, maximum and mean temperatures (deg C) matching the
resolution of dtmf.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Cold air drainage is calculated by delineating hydrological basins and
calculating flow accumulation and the elevation difference from the highest point of the basin.
Cold-air drainage is assumed to occur when atmospheric stability is high, namely when
the radiation balance is negative and wind speeds are low. Coastal effects are
calculated by determining the ratio of land to sea pixels in an upwind direction.
The provision of <code>dtmm</code> allows this ratio to be derived accoutning for land and
sea outside the boundaries of the study area.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">climdata</span><span class="op">&lt;-</span><span class="fu"><a href="read_climdata.html">read_climdata</a></span><span class="op">(</span><span class="fu">mesoclim</span><span class="fu">::</span><span class="va"><a href="ukcpinput.html">ukcpinput</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dtmf</span><span class="op">&lt;-</span><span class="fu">rast</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/dtms/dtmf.tif"</span>,package<span class="op">=</span><span class="st">"mesoclim"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dtmm</span><span class="op">&lt;-</span><span class="fu">rast</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/dtms/dtmm.tif"</span>,package<span class="op">=</span><span class="st">"mesoclim"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">basins</span><span class="op">&lt;-</span><span class="fu"><a href="basindelin.html">basindelin</a></span><span class="op">(</span><span class="va">dtmf</span>, boundary <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wsf</span><span class="op">&lt;-</span><span class="fu"><a href="winddownscale.html">winddownscale</a></span><span class="op">(</span><span class="va">climdata</span><span class="op">$</span><span class="va">windspeed</span>, <span class="va">climdata</span><span class="op">$</span><span class="va">winddir</span>, <span class="va">dtmf</span>, <span class="va">dtmm</span>, <span class="va">climdata</span><span class="op">$</span><span class="va">dtm</span>, zi<span class="op">=</span><span class="va">climdata</span><span class="op">$</span><span class="va">windheight_m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000 1000</span>
<span class="r-in"><span><span class="va">dailytemps</span><span class="op">&lt;-</span><span class="fu">tempdaily_downscale</span><span class="op">(</span><span class="va">climdata</span>,<span class="cn">NA</span>,<span class="fu">unwrap</span><span class="op">(</span><span class="fu">mesoclim</span><span class="fu">::</span><span class="va"><a href="ukcp18sst.html">ukcp18sst</a></span><span class="op">)</span>,<span class="va">dtmf</span>,<span class="va">dtmm</span>,<span class="va">basins</span>,<span class="va">wsf</span>,cad <span class="op">=</span> <span class="cn">TRUE</span>,coastal <span class="op">=</span> <span class="cn">TRUE</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">panel</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dailytemps</span><span class="op">$</span><span class="va">tmin</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span>,<span class="va">dailytemps</span><span class="op">$</span><span class="va">tmax</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span>,<span class="va">dailytemps</span><span class="op">$</span><span class="va">tmean</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tmin"</span>,<span class="st">"Tmax"</span>,<span class="st">"Tmean"</span><span class="op">)</span>,<span class="st">"13/05/2018"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tempdaily_downscale-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ilya Maclean, Alexandra Gardner, Jonathan Mosedale.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

